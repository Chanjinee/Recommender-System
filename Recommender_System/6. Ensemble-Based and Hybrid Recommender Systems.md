
# 6. Ensemble-Based and Hybrid Recommender Systems

## Hybrid System
<img src="./img/category%20of%20hybrid%20systems.jpg" width="800" height="500"/>

- 하이브리드 추천시스템
	>- 다양한 추천 시스템의 알고리즘을 사용해 보다 뛰어난 성능을 가진 알고리즘을 만들어낼 수 있음
	>- 일반적으로 사용하는 '앙상블' 보다 더 큰 개념임
	- ex) 5장에서 논의한 세가지 종류의 추천방법
	>- 협업 방법(Collaborative Filtering RS) 
	>- 콘텐츠 기반 방법(Content-Based RS)
	>- 지식 기반 방법(Knowledge-Based RS)
	>- -> 세가지 방법들은 다른 각자 다른 데이터 소스를 사용하며, 각기 다른 강점과 약점을 지닌다.
	>- -> 이 세가지 방식을 사용해 더 좋은 성능을 내는 알고리즘을 만들어낼 수 있음
	>- -> 서로 다른 모델들을 결합하는 것 뿐 아니라 서로 같은 모델을 결합할 수도 있음( ex)콘텐츠 및 지식기반)

- 하이브리드 추천시스템을 만드는 세가지 기본 방법
	1. 앙상블 디자인
	>- 우리가 알고 있는 머신러닝에서의 앙상블 방법과 유사함
	>- 다양한 예측의 가중 평균 계산, 등
	>- a)  __기존 추천모델의 방식을 그대로__ 사용, b) __단일화된__ 점수 또는 순위를 생성

	2. 모놀리틱 디자인
	>- Monolithic: 단단히 짜여 하나로 되어있는
	>- 다양한 데이터 유형을 사용
	>- 다른 경우와 다르게 알고리즘들 사이에 명확한 구별이 존재하지 않을 수 있음
	>- 구별이 명확한 경우에도 __기존의 알고리즘을 수정해서__ 사용할 수도 있음
	>- 개별 요소를 더욱 긴밀하게 통합하는 경향이 있음
	>- 모든 개별 구성 요소가 __기존의 단일 알고리즘과 같은 것은 아님__
	3. 혼합 시스템
	>- 여러 알고리즘들을 기존의 단일 알고리즘으로 사용
	>- 다양한 시스템에 의한 추천 아이템이 나란히 표시됨
	>- 때문에 단일 아이템의 추천을 개별적으로 보는 것보단 __추천을 생성하는 아이템의 조합에__ 더 focus가 맞추어져 있음
# Hybrid System 분류
## Hybrid System - Ensemble - Parallel
<img src="./img/parallel design.jpg" width="500" height="250"/>

### 1. 가중(weighted)
	- 개별 추천 시스템의 결과를 가중 집계하여 최종 결과를 도출
	- 좀 더 정확한 시스템에 중요성을 부과하기 위해 더 큰 가중치를 사용하는 것이 이상적
	- 직관적(huristic)인 방식을 사용하거나 공식 통계 모델을 사용
>가중치를 어떻게 매겨야 할까?
>- 간단한 접근 방법은 평점 행렬을 __train과 valid로 나눈 후__ 예측 행렬을 MSE, MAE를 사용해 __평가__
>- 독립적인 변수를 선택해 선형 조합의 MSE가 최소가 되도록 하는 함
>- 선형 회귀를 사용해 가중치를 학습한 후 전체 훈련 세트에서 __재교육__, __재학습__ 됨
>- 일반적인 방법은 __경사하강법(Gradient Descent)을__ 사용하는 것
>- 과적합 방지를 위해 규제, 정규화, 제약 추가 가능

	- 평가지표? 
	> MSE는 이상치에 민감. MAE를 사용함으로 보완 가능

> 1.1 다양한 유형의 모델 조합
>- 1. 동종 데이터 유형 및 모델 클래스
		- __다른__ 모델이 __동일한 데이터에__ 적용됨
		- 이웃기반방법, SVD, 베이즈 기술 등의 모델을 사용 후 가중합 
>- 2. 이기종 데이터 유형 및 모델 클래스
		- __다른__ 모델이 __다른 데이터에__ 적용됨
		- 여러 데이터 소스의 힘을 결합 프로세스에 통합
		- 가중치를 신중하게 부여하는 것이 중요
		- 협업 기반 + 콘텐츠기반
 
> 1.2 분류에서의 배깅 적응
>- 행단위 부트 스트래핑
>- 행단위 서브 샘플링
>- 엔트리 단위 배깅
>- 엔트리 단위 서브 샘플링 
-> 배깅에서 최대의 성능을 내기 위해 __낮은 바이어스와 높은 분산을__ 갖는 상관되지 않은 기본 모델을 사용하는 것이 좋음


### 2. 스위칭(switching)
	- 현재 요구(분석 상황에 맞게 고려)에 따라 사용 모델을 변경
	- cold start문제를 해결하는데에 효과적임
> 2.1 모델 버킷
>- 머신러닝의 방법에서와 같이 train valid로 나누어 효과적인 모델을 찾음
>- 모델 버킷이 동적인 경우, 시스템의 전환(스위칭)이 이루어짐
>- 모델 버킷이 정적인 경우, 한 요소의 가중치를 1로 두고 나머지 구성요소의 가중치를 0으로 둔 가중 모델로 볼 수 있음

## Hybrid System - Ensemble - Sequential
<img src="./img/sequential design.jpg" width="500" height="200"/>

### 3. 캐스케이드(cascade)
	- 한 추천 시스템은 다른 추천시스템에 의해 제시된 추천을 수정
	- 동일한 가중치를 주고 시작하여 잘 학습하지 못한(오류가 있는) 예제의 가중치는 증가, 잘 학습된 예제의 가중치는 감소
	- 모든 가중치의 합은 항상 1로 정규화됨
	- 협업 필터링의 경우 가중치는 개별 평점과 연관됨
	- ex) Boosting - 연쇄적인 모델 학습을 통해 최종적으로 단일 결과 출력


### 4. 피처 보강(Feature augmentation)
	- 한 추천 시스템의 출력을 다음 추천 시스템의 입력으로 받는 방식
	- 분류에서 사용되는 Stacking의 개념과 유사
	- 일부는 기존 추천모델에 대한 약간의 변경이 필요하기 때문에 모놀리틱 방식으로 간주될 수 있음 (점선)

## Hybrid System - Monolithic

### 5. 피처 결합(Feature combination)
	- 여러 데이터 소스의 특징이 단일 추천 시스템 맥락에 결합돼 사용됨

### 6. 메타레벨(Meta-level)
	 - 한 추천 시스템이 사용하는 모델이 다른 시스템의 입력으로 사용됨
	 - ex) 콘텐츠기반 협업시스템 
	 - 첫번째 단계에서 콘텐츠 기반 알고리즘으로 각 사용자에 대해 차별적인 벡터공간 표현을 생성. 관련없는 단어 제거
	 - 따라서 새로운 표현으로 사용자 간의 유사도를 강력하게 계산 가능
	 - -> 기존의 방식으로 두 알고리즘을 사용하는 것이 아니라 협업시스템을 수정하여 콘텐츠기반 알고리즘을 사용함

## Hybrid System - Mixed

### 7. 혼합(Mixed)
	- 여러 엔진의 추천 사항이 동시에 사용자에게 제공됨
	- 주로 지식 기반 추천 시스템과 함께 사용됨
	- ex) 복합 TV 프로그램
